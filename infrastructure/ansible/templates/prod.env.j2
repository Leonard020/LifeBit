# LifeBit í”„ë¡œë•ì…˜ í™˜ê²½ ë³€ìˆ˜
# ìƒì„± ì‹œê°„: {{ ansible_date_time.iso8601 }}

# ===============================================================
# ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
# ===============================================================
POSTGRES_DB={{ postgres_db | default('lifebit_db') }}
POSTGRES_USER={{ postgres_user | default('lifebit_user') }}
POSTGRES_PASSWORD={{ postgres_password | default('lifebit_password') }}

# ===============================================================
# ğŸŒ ë„ë©”ì¸ ë° í™˜ê²½ ì„¤ì •
# ===============================================================
DOMAIN_NAME={{ domain_name | default(ansible_host) }}
NODE_ENV=production
ENVIRONMENT=production
SPRING_PROFILES_ACTIVE=production

# ===============================================================
# ğŸ¤– AI ì„œë¹„ìŠ¤ ì„¤ì •
# ===============================================================
OPENAI_API_KEY={{ openai_api_key | default('') }}
USE_GPT={{ use_gpt | default('False') }}

# ===============================================================
# ğŸ”‘ ì†Œì…œ ë¡œê·¸ì¸ ì„¤ì •
# ===============================================================
VITE_GOOGLE_CLIENT_ID={{ google_client_id | default('') }}
VITE_KAKAO_CLIENT_ID={{ kakao_client_id | default('') }}
GOOGLE_CLIENT_ID={{ google_client_id | default('') }}
KAKAO_CLIENT_ID={{ kakao_client_id | default('') }}

# ===============================================================
# ğŸ” JWT ì„¤ì •
# ===============================================================
JWT_SECRET={{ jwt_secret | default('lifebit-production-jwt-secret-' + ansible_date_time.epoch) }}
JWT_ALGORITHM={{ jwt_algorithm | default('HS256') }}
JWT_EXPIRE_MINUTES={{ jwt_expire_minutes | default('60') }}
VITE_JWT_SECRET_KEY={{ jwt_secret | default('lifebit-production-jwt-secret-' + ansible_date_time.epoch) }}

# ===============================================================
# ğŸŒ CORS ì„¤ì •
# ===============================================================
{% if domain_name is defined and domain_name != ansible_host and domain_name != "" %}
CORS_ORIGINS=https://{{ domain_name }},http://{{ domain_name }},http://{{ domain_name }}:80,http://{{ domain_name }}:3000
CORS_ALLOWED_ORIGINS=https://{{ domain_name }},http://{{ domain_name }},http://{{ domain_name }}:80,http://{{ domain_name }}:3000
{% else %}
CORS_ORIGINS=http://{{ ansible_host }},http://{{ ansible_host }}:80,http://{{ ansible_host }}:3000
CORS_ALLOWED_ORIGINS=http://{{ ansible_host }},http://{{ ansible_host }}:80,http://{{ ansible_host }}:3000
{% endif %}

# ===============================================================
# ğŸ”„ ë¦¬ë‹¤ì´ë ‰íŠ¸ URI ì„¤ì •
# ===============================================================
{% if domain_name is defined and domain_name != ansible_host and domain_name != "" %}
KAKAO_REDIRECT_URI={{ kakao_redirect_uri | default('https://' + domain_name + '/auth/kakao/callback') }}
GOOGLE_REDIRECT_URI={{ google_redirect_uri | default('https://' + domain_name + '/auth/google/callback') }}
{% else %}
KAKAO_REDIRECT_URI={{ kakao_redirect_uri | default('http://' + ansible_host + ':3000/auth/kakao/callback') }}
GOOGLE_REDIRECT_URI={{ google_redirect_uri | default('http://' + ansible_host + ':3000/auth/google/callback') }}
{% endif %}

# ===============================================================
# ğŸ“Š ë¡œê¹… ì„¤ì •
# ===============================================================
LOG_LEVEL={{ log_level | default('info') }}

# ===============================================================
# ğŸ”§ Spring Boot ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
# ===============================================================
SPRING_DATASOURCE_URL=jdbc:postgresql://postgres-db:5432/{{ postgres_db | default('lifebit_db') }}?stringtype=unspecified&connectTimeout=30&socketTimeout=60&loginTimeout=30&ApplicationName=LifeBit-Core-API
SPRING_DATASOURCE_USERNAME={{ postgres_user | default('lifebit_user') }}
SPRING_DATASOURCE_PASSWORD={{ postgres_password | default('lifebit_password') }}
SPRING_JPA_HIBERNATE_DDL_AUTO=update
SPRING_JPA_SHOW_SQL=false
SPRING_JPA_DATABASE_PLATFORM=org.hibernate.dialect.PostgreSQLDialect
SPRING_DATASOURCE_DRIVER_CLASS_NAME=org.postgresql.Driver
SPRING_JPA_PROPERTIES_HIBERNATE_JDBC_TIME_ZONE=Asia/Seoul

# ===============================================================
# ğŸ AI API ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
# ===============================================================
DATABASE_URL=postgresql://{{ postgres_user | default('lifebit_user') }}:{{ postgres_password | default('lifebit_password') }}@postgres-db:5432/{{ postgres_db | default('lifebit_db') }}?connect_timeout=30&application_name=LifeBit-AI-API
DB_HOST=postgres-db
DB_PORT=5432
DB_NAME={{ postgres_db | default('lifebit_db') }}
DB_USER={{ postgres_user | default('lifebit_user') }}
DB_PASSWORD={{ postgres_password | default('lifebit_password') }}

# ===============================================================
# ğŸŒ í”„ë¡ íŠ¸ì—”ë“œ API URL ì„¤ì •
# ===============================================================
{% if domain_name is defined and domain_name != ansible_host and domain_name != "" %}
VITE_CORE_API_URL=https://{{ domain_name }}/api
VITE_AI_API_URL=https://{{ domain_name }}/ai-api
{% else %}
VITE_CORE_API_URL=http://{{ ansible_host }}/api
VITE_AI_API_URL=http://{{ ansible_host }}/ai-api
{% endif %}

# ===============================================================
# ğŸ“§ ì´ë©”ì¼ ì„¤ì • (ì„ íƒì‚¬í•­)
# ===============================================================
EMAIL_FROM={{ email_from | default('noreply@lifebit.com') }}
SMTP_HOST={{ smtp_host | default('') }}
SMTP_PORT={{ smtp_port | default('') }}
SMTP_USER={{ smtp_user | default('') }}
SMTP_PASS={{ smtp_pass | default('') }}

# ===============================================================
# ğŸ”’ ë³´ì•ˆ ì„¤ì •
# ===============================================================
# HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ í™œì„±í™” (ë„ë©”ì¸ì´ ìˆì„ ë•Œë§Œ)
{% if domain_name is defined and domain_name != ansible_host and domain_name != "" %}
FORCE_HTTPS=true
{% else %}
FORCE_HTTPS=false
{% endif %}